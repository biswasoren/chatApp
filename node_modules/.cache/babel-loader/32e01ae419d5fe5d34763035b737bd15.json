{"ast":null,"code":"var _jsxFileName = \"/home/biswa/chatApp/src/components/box.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './box.css';\nimport { socket } from './socket';\n\nclass Box extends React.Component {\n  // static propTypes = {\n  //   height: PropTypes.string.isRequired;\n  // };\n  // eslint-disable-next-line no-useless-constructor\n  constructor(props) {\n    super(props);\n\n    this.scrollToBottom = () => {\n      this.messagesEnd.scrollIntoView();\n    };\n\n    this.scrollToBottomSooth = () => {\n      this.messagesEnd.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    };\n\n    this.getMessages = () => {\n      fetch('/api/message/getAll').then(results => results.json()).then(info => {\n        const msgData = [];\n        const data = info;\n        data.forEach(element => {\n          const obj = {};\n          obj.msg = element.message;\n          obj.time = element.time;\n          obj.tone = element.tone;\n          obj.sent_from = element.sent_from;\n          msgData.push(obj);\n        });\n        console.log(msgData);\n        this.setState({\n          msgData,\n          msgLen: msgData.length\n        });\n      });\n    };\n\n    this.setImage = tone => {\n      const imageEmotionMap = {\n        Joy: 'happy.svg',\n        Anger: 'angry.svg',\n        Sadness: 'sad.svg',\n        Fear: 'sad.svg'\n      };\n      if (Object.keys(imageEmotionMap).includes(tone)) return imageEmotionMap[tone];else return 'normal.svg';\n    };\n\n    this.state = {\n      msgData: []\n    };\n  } // eslint-disable-next-line react/no-typos\n\n\n  componentDidMount() {\n    socket.on('get_msg', data => {\n      const msgData = this.state.msgData;\n      const obj = {};\n      obj.msg = data.message;\n      obj.time = data.time;\n      obj.tone = data.tone;\n      obj.sent_from = data.sent_from;\n      msgData.push(obj);\n      this.setState({\n        msgData\n      }, () => {\n        this.scrollToBottomSooth();\n      });\n    });\n    this.getMessages();\n  }\n\n  componentDidUpdate() {\n    if (this.state.msgLen === this.state.msgData.length) this.scrollToBottom();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        overflow: 'overlay'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, this.state.msgData ? this.state.msgData.map(msg => React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \" \", msg.sent_from), React.createElement(\"div\", {\n      className: \"message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, msg.msg), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.setImage(msg.tone),\n      style: {\n        width: '30px'\n      },\n      alt: \"emogi\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"time\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, new Date(\"\".concat(msg.time)).toLocaleTimeString(), \" (\", new Date(\"\".concat(msg.time)).toDateString(), \")\")))) : null, React.createElement(\"div\", {\n      style: {\n        float: \"left\",\n        clear: \"both\"\n      },\n      ref: el => {\n        this.messagesEnd = el;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Box;","map":{"version":3,"sources":["/home/biswa/chatApp/src/components/box.js"],"names":["React","PropTypes","socket","Box","Component","constructor","props","scrollToBottom","messagesEnd","scrollIntoView","scrollToBottomSooth","behavior","getMessages","fetch","then","results","json","info","msgData","data","forEach","element","obj","msg","message","time","tone","sent_from","push","console","log","setState","msgLen","length","setImage","imageEmotionMap","Joy","Anger","Sadness","Fear","Object","keys","includes","state","componentDidMount","on","componentDidUpdate","render","overflow","map","width","Date","toLocaleTimeString","toDateString","float","clear","el"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport './box.css'\nimport { socket } from './socket';\n\nclass Box extends React.Component {\n\n  // static propTypes = {\n  //   height: PropTypes.string.isRequired;\n  // };\n    // eslint-disable-next-line no-useless-constructor\n    constructor(props) {\n      super(props);\n      this.state = {\n        msgData: [],\n      }\n    }\n  \n    // eslint-disable-next-line react/no-typos\n    componentDidMount() {\n\n    socket.on('get_msg', (data) =>  {\n      const msgData = this.state.msgData;\n      const obj ={};\n      obj.msg = data.message;\n      obj.time = data.time;\n      obj.tone = data.tone;\n      obj.sent_from = data.sent_from;\n      \n      \n      msgData.push(obj);\n\n      this.setState({ \n        msgData,\n      }, () => {\n        this.scrollToBottomSooth();\n      });\n    });  \n    \n    this.getMessages();\n    }\n\n    componentDidUpdate() {\n      if (this.state.msgLen === this.state.msgData.length)\n        this.scrollToBottom();\n    }\n\n    scrollToBottom = () => {\n      this.messagesEnd.scrollIntoView()\n    }\n\n    scrollToBottomSooth = () => {\n      this.messagesEnd.scrollIntoView({ behavior: \"smooth\" })\n    }\n\n    getMessages = () => {\n        fetch('/api/message/getAll')\n        .then(results => results.json())\n        .then(info => {\n          const msgData = [];\n            const data = info;\n            data.forEach(element => {\n              const obj ={};\n              obj.msg = element.message;\n              obj.time = element.time;\n              obj.tone = element.tone;\n              obj.sent_from = element.sent_from;\n              msgData.push(obj);\n            });\n            console.log(msgData)\n            this.setState({ \n              msgData,\n              msgLen: msgData.length\n\n            });\n        });\n    }\n\n    setImage = (tone) => {\n      const imageEmotionMap = {\n        Joy: 'happy.svg',\n        Anger: 'angry.svg',\n        Sadness: 'sad.svg',\n        Fear: 'sad.svg'\n      }\n      if (Object.keys(imageEmotionMap).includes(tone))\n        return imageEmotionMap[tone];\n      else \n        return 'normal.svg'\n    }\n  \n    render() {\n      return (\n        <div style={{ overflow: 'overlay'}}>\n        {this.state.msgData ? this.state.msgData.map(msg => \n        <div>\n          <div> {msg.sent_from}\n            </div>\n          <div className=\"message\">\n          <div className=\"msg\">{msg.msg}</div>\n          <div><img src={this.setImage(msg.tone)} style={{width: '30px'}} alt='emogi'/></div>\n          <div className=\"time\">{new Date(`${msg.time}`).toLocaleTimeString() } ({new Date(`${msg.time}`).toDateString()})</div>\n          </div>\n        </div>\n          ): null}\n          <div style={{ float:\"left\", clear: \"both\" }}\n             ref={(el) => { this.messagesEnd = el; }}>\n        </div>\n        </div>\n      );\n    }\n  }\n\n  export default (Box);"]},"metadata":{},"sourceType":"module"}